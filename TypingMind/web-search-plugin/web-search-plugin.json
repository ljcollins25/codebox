{
  "uuid": "web-search",
  "emoji": "üîç",
  "title": "Web Search",
  "openaiSpec": {
    "name": "web_search",
    "description": "Search the web using an OpenAI-compatible API with web search bots. Returns search results for the LLM to use in answering questions.",
    "parameters": {
      "type": "object",
      "properties": {
        "query": {
          "type": "string",
          "description": "The search query to look up on the web. Be specific and include relevant keywords for best results."
        },
        "searchBot": {
          "type": "string",
          "enum": ["Gray-Search", "Web-Search", "Claude-3.5-Sonnet-Search", "GPT-4o-Search", "Gemini-2.0-Flash-Search"],
          "description": "Override which search bot to use. If not specified, uses the user's default setting."
        }
      },
      "required": ["query"]
    }
  },
  "userSettings": [
    {
      "name": "apiKey",
      "label": "API Key",
      "type": "password",
      "description": "API key for the OpenAI-compatible service"
    },
    {
      "name": "apiBaseUrl",
      "label": "API Base URL",
      "type": "text",
      "default": "https://api.poe.com/v1",
      "description": "Base URL for the OpenAI-compatible API"
    },
    {
      "name": "searchBot",
      "label": "Search Bot",
      "type": "select",
      "options": [
        { "label": "Gray-Search", "value": "Gray-Search" },
        { "label": "Web-Search", "value": "Web-Search" },
        { "label": "Claude-3.5-Sonnet-Search", "value": "Claude-3.5-Sonnet-Search" },
        { "label": "GPT-4o-Search", "value": "GPT-4o-Search" },
        { "label": "Gemini-2.0-Flash-Search", "value": "Gemini-2.0-Flash-Search" }
      ],
      "default": "Gray-Search",
      "description": "Which bot to use for web searches"
    }
  ],
  "implementationCode": "async function webSearch(params, userSettings) {\n  const { query, searchBot: overrideBot } = params;\n  const { apiKey, apiBaseUrl = 'https://api.poe.com/v1', searchBot = 'Gray-Search' } = userSettings;\n\n  const bot = overrideBot || searchBot;\n\n  if (!query || typeof query !== 'string' || query.trim() === '') {\n    throw new Error('Please provide a valid search query.');\n  }\n\n  if (!apiKey) {\n    throw new Error('API key is required. Please configure it in the plugin settings.');\n  }\n\n  const response = await fetch(`${apiBaseUrl}/chat/completions`, {\n    method: 'POST',\n    headers: {\n      'Authorization': `Bearer ${apiKey}`,\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      model: bot,\n      messages: [{ role: 'user', content: query }],\n      stream: false\n    })\n  });\n\n  if (!response.ok) {\n    const errorText = await response.text();\n    throw new Error(`API error (${response.status}): ${errorText}`);\n  }\n\n  const data = await response.json();\n  const content = data.choices?.[0]?.message?.content;\n\n  if (!content) {\n    throw new Error('No response received from search bot');\n  }\n\n  return content;\n}"
}
